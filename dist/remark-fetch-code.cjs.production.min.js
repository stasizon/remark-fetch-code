"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("node-fetch")),n=e(require("unist-util-visit")),r=e(require("url-join")),i=require("os");function u(e,t){return t?function(e){let t;return e.forEach(e=>{const n=e.match(/^\s+/);e&&(n&&n[0]?(void 0===t&&(t=n[0].length),n[0].length>0&&n[0].length<t&&(t=n[0].length)):t=0)}),e.map(e=>e.slice(t))}(function(e,t){let n=0,r=e.length;return e.forEach((e,i)=>{e.includes("START "+t)&&(n=i+1),e.includes("END "+t)&&(r=i)}),e.slice(n,r)}(e.split(i.EOL),t)).join(i.EOL):e}function o(e=""){const t=e.split(" ");let n,r;for(const e of t)e.startsWith("url=")&&(n=e.replace("url=","")),e.startsWith("tag=")&&(r=e.replace("tag=",""));return{url:n,tag:r}}exports.default=function(e){return async function(l){const s=[],c=[];n(l,"code",e=>s.push(e));for(const n of s){if(!n.meta){c.push(new Promise(e=>e(n)));continue}const{url:l,tag:s}=o(n.meta);if(!l){c.push(new Promise(e=>e(n)));continue}const a=e&&e.pathPrefix?r(e.pathPrefix,l):l;c.push(new Promise((r,o)=>{t(a).then(e=>e.text()).then(t=>{n.value=u(t,s),null!=e&&e.replaceTabsToSpaces&&(n.value=n.value.split(i.EOL).map(e=>e.replace(/\t/g,"  ")).join(i.EOL)),r(n)}).catch(e=>o(e))}))}c.length&&await Promise.all(c)}};
//# sourceMappingURL=remark-fetch-code.cjs.production.min.js.map
